#!/bin/bash

# Quick start script for Media Stack

set -e

echo "🚀 Starting Media Stack..."

# Check if .env exists
if [ ! -f .env ]; then
    echo "❌ .env file not found! Please copy .env.example to .env and configure it first."
    echo "   cp .env.example .env"
    echo "   nano .env"
    exit 1
fi

# Check if Docker is running
if ! docker info >/dev/null 2>&1; then
    echo "❌ Docker is not running. Please start Docker first."
    exit 1
fi

# Pull latest images
echo "📥 Pulling latest Docker images..."
docker-compose pull

# Start services
echo "🔄 Starting services..."
docker-compose up -d

# Wait a moment for services to start
sleep 5

# Show status
echo "📊 Service status:"
docker-compose ps

echo ""
echo "✅ Media Stack started successfully!"
echo ""
echo "🌐 Access your services at:"
echo "   Jellyfin:     https://jellyfin.$(grep DOMAIN= .env | cut -d= -f2)"
echo "   Overseerr:    https://overseerr.$(grep DOMAIN= .env | cut -d= -f2)"
echo "   Prowlarr:     https://prowlarr.$(grep DOMAIN= .env | cut -d= -f2)"
echo "   Sonarr:       https://sonarr.$(grep DOMAIN= .env | cut -d= -f2)"
echo "   Radarr:       https://radarr.$(grep DOMAIN= .env | cut -d= -f2)"
echo "   qBittorrent:  https://qbittorrent.$(grep DOMAIN= .env | cut -d= -f2)"
echo ""
echo "📚 See MEDIA_STACK_SETUP.md for detailed configuration instructions"
echo "📋 Check logs: docker-compose logs -f [service-name]"